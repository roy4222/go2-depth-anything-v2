# 2025-12-21 é–‹ç™¼ç­†è¨˜ (W8 Day 7)

**æ—¥æœŸï¼š** 2025/12/21ï¼ˆæ˜ŸæœŸå…­ï¼‰  
**ç›®æ¨™ï¼š** MCP Tools é–‹ç™¼ + ç«¯åˆ°ç«¯æ•´åˆæ¸¬è©¦  
**é—œéµé‡Œç¨‹ç¢‘ï¼š** 2026/1/7 ç¬¬ä¸€éšæ®µç™¼è¡¨ï¼ˆå‰©é¤˜ 17 å¤©ï¼‰

---

## ğŸ“Š å°ˆæ¡ˆç‹€æ…‹ç¸½è¦½

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| **ç•¶å‰é€±æ¬¡** | W8 Day 7ï¼ˆç¬¬äºŒå€‹æœˆï¼‰|
| **æ•´é«”é€²åº¦** | ç´„ 85% |
| **ç™¼è¡¨å€’æ•¸** | 17 å¤© |

### æ˜¨æ—¥æˆæœï¼ˆ12/20ï¼‰

- âœ… **æ„ŸçŸ¥èåˆç³»çµ±ä¸Šç·š**ï¼ˆPort 8001ï¼‰
- âœ… ç¸½æ¨è«–æ™‚é–“ï¼š**380ms**ï¼ˆYOLO 42ms + DA3 289msï¼‰
- âœ… è·é›¢ä¼°è¨ˆèª¤å·®ï¼š**4.4%**ï¼ˆæ¤…å­æ ¡æ­£å®Œæˆï¼‰
- âœ… `/find_object` + `/find_object/summary` API å°±ç·’

---

## ğŸ¯ åŸ·è¡Œæ‘˜è¦

### æŠ€è¡“æ¶æ§‹

```
Claude Desktop / Kilo Code
    â†“ MCP
ROS MCP Server (server.py)
    â”œâ”€ find_object â†’ HTTP â†’ GPU Server (140.136.155.5:8001)
    â””â”€ go2_perform_action â†’ rosbridge â†’ /perform_action Service â†’ Go2
```

### ä»Šæ—¥ç›®æ¨™

| Phase | ç›®æ¨™ | å„ªå…ˆç´š | é ä¼°æ™‚é–“ |
|-------|------|--------|---------|
| **Phase 0** | ç’°å¢ƒé©—è­‰ | ğŸ”´ å‰ç½® | 30 åˆ†é˜ |
| **Phase 1** | `find_object` MCP Tool | ğŸ”´ é«˜ | 1-1.5 å°æ™‚ |
| **Phase 2** | `go2_perform_action` MCP Tool | ğŸŸ¡ ä¸­ | 1.5 å°æ™‚ |
| **Phase 3** | æ•´åˆæ¸¬è©¦ | ğŸŸ¡ ä¸­ | 1.5 å°æ™‚ |
| **Phase 4** | å‚™æ¡ˆå½±ç‰‡è…³æœ¬ | ğŸŸ¡ ä¸­ | 0.5 å°æ™‚ |

**é ä¼°ç¸½æ™‚é–“ï¼š** 4-5 å°æ™‚

---

## ğŸ”§ Phase 0ï¼šç’°å¢ƒé©—è­‰ (30 åˆ†é˜)

### 0.1 å•Ÿå‹• GPU Server

```bash
# Terminal 1: SSH åˆ° GPU Server
ssh -p 8022 roy422@140.136.155.5

# å•Ÿå‹• perception server
source ~/miniconda3/bin/activate depth-v2
cd ~/Yoloworld
uvicorn perception_server_v2:app --host 0.0.0.0 --port 8001
```

### 0.2 æ¸¬è©¦ GPU Server é€£ç·š

```bash
# Terminal 2: åœ¨ Mac VM æ¸¬è©¦
curl http://140.136.155.5:8001/

# æ‡‰è©²å›å‚³ {"status": "ok"} æˆ–é¡ä¼¼è¨Šæ¯
```

### 0.3 ç¢ºèª ROS2 ç’°å¢ƒ

```bash
# Terminal 3: ç¢ºèª rosbridge é‹è¡Œ
ros2 node list | grep rosbridge

# Terminal 4: å•Ÿå‹• Go2 driverï¼ˆè‹¥æœªå•Ÿå‹•ï¼‰
cd /home/roy422/ros2_ws/src/elder_and_dog
source install/setup.bash
export ROBOT_IP="192.168.12.1"
export CONN_TYPE="webrtc"
ros2 launch go2_robot_sdk robot.launch.py rviz2:=false
```

### é©—æ”¶æ¨™æº–

- [ ] GPU Server API å¯è¨ªå• (HTTP 200)
- [ ] rosbridge æ­£å¸¸é‹è¡Œ
- [ ] Go2 driver node æ­£å¸¸é‹è¡Œ

---

## ğŸ¯ Phase 1ï¼šfind_object MCP Tool (ğŸ”´ é«˜å„ªå…ˆ)

### æŠ€è¡“è¦æ ¼

```python
@mcp.tool()
async def find_object(
    target: str,
    camera_topic: str = "/camera/image_raw",
    timeout: float = 30.0,
    gpu_server_url: str = "http://140.136.155.5:8001"
) -> dict:
    """
    ä½¿ç”¨ YOLO + DA3 æœå°‹æŒ‡å®šç‰©ä»¶
    
    æµç¨‹ï¼š
    1. å¾ Go2 æ”åƒé ­å–å¾—åœ–ç‰‡
    2. POST åˆ° GPU Server /find_object/summary
    3. å›å‚³çµæœçµ¦ LLM
    """
```

### ä¿®æ”¹æª”æ¡ˆ

| æª”æ¡ˆ | ä¿®æ”¹å…§å®¹ |
|------|---------|
| `ros-mcp-server/server.py` | æ–°å¢ `find_object` Tool (~90 è¡Œ) |

### å¯¦ä½œæ­¥é©Ÿ

1. **å®‰è£ä¾è³´**
   ```bash
   cd /home/roy422/ros2_ws/src/elder_and_dog/ros-mcp-server
   uv pip install httpx
   ```

2. **ä¿®æ”¹ server.py**ï¼ˆè©³è¦‹å¯¦ä½œè¨ˆç•«ï¼‰

3. **æ¸¬è©¦**
   ```
   User: è«‹ä½¿ç”¨ find_object å°‹æ‰¾ bottle
   ```

### é©—æ”¶æ¨™æº–

- [ ] æˆåŠŸå–å¾— Go2 ç›¸æ©Ÿå½±åƒ
- [ ] HTTP è«‹æ±‚æˆåŠŸé€é” GPU Server
- [ ] å›æ‡‰åŒ…å« `found`, `distance_m`, `direction`, `cmd_vel`
- [ ] éŒ¯èª¤è™•ç†æ­£ç¢ºï¼ˆè¶…æ™‚ã€API å¤±æ•—ç­‰ï¼‰
- [ ] ç¸½å›æ‡‰æ™‚é–“ < 5 ç§’

---

## ğŸ¯ Phase 2ï¼šgo2_perform_action MCP Tool (ğŸŸ¡ ä¸­å„ªå…ˆ)

### æŠ€è¡“è¦æ ¼

æ–¹æ¡ˆï¼šé€é ROS2 Service åŒ…è£å‹•ä½œå‘½ä»¤

```
MCP Tool â†’ call_service â†’ /perform_action â†’ Go2 WebRTC â†’ æ©Ÿå™¨ç‹—
```

### æ–°å¢æª”æ¡ˆ

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| `go2_interfaces/srv/PerformAction.srv` | Service è¨Šæ¯å®šç¾© |

### ä¿®æ”¹æª”æ¡ˆ

| æª”æ¡ˆ | ä¿®æ”¹å…§å®¹ |
|------|---------|
| `go2_interfaces/CMakeLists.txt` | è¨»å†Š PerformAction.srv |
| `go2_robot_sdk/.../robot_control_service.py` | æ–°å¢ `perform_action()` æ–¹æ³• |
| `go2_robot_sdk/.../go2_driver_node.py` | æ–°å¢ Service callback |
| `ros-mcp-server/server.py` | æ–°å¢ `go2_perform_action` Tool |

### å‹•ä½œæ¸…å–®ï¼ˆ1/7 Demo å„ªå…ˆï¼‰

| å‹•ä½œ | API ID | èª¿ç”¨æ–¹å¼ |
|------|--------|----------|
| StandUp | 1004 | `go2_perform_action("StandUp")` |
| StandDown | 1005 | `go2_perform_action("StandDown")` |
| **Hello** | 1016 | `go2_perform_action("Hello")` â­ |
| **Dance1** | 1022 | `go2_perform_action("Dance1")` â­ |
| **FingerHeart** | 1036 | `go2_perform_action("FingerHeart")` â­ |

### å¯¦ä½œæ­¥é©Ÿ

1. **å»ºç«‹ Service è¨Šæ¯**ï¼ˆPerformAction.srvï¼‰
2. **ä¿®æ”¹ CMakeLists.txt**ï¼ˆè¨»å†Šè¨Šæ¯ï¼‰
3. **æ“´å…… RobotControlService**
4. **ä¿®æ”¹ go2_driver_node**ï¼ˆæ–°å¢ Serviceï¼‰
5. **æ–°å¢ MCP Tool**
6. **å»ºæ§‹èˆ‡æ¸¬è©¦**

### å»ºæ§‹æŒ‡ä»¤

```bash
cd /home/roy422/ros2_ws/src/elder_and_dog
colcon build --packages-select go2_interfaces --cmake-force-configure
colcon build --packages-select go2_robot_sdk
source install/setup.bash
```

### é©—æ”¶æ¨™æº–

- [ ] Service è¨Šæ¯æˆåŠŸç·¨è­¯
- [ ] go2_driver_node æˆåŠŸè¨»å†Š Service
- [ ] MCP Tool æˆåŠŸå‘¼å« Service
- [ ] Go2 å¯¦éš›åŸ·è¡Œå‹•ä½œ
- [ ] éŒ¯èª¤è™•ç†æ¶µè“‹ç„¡æ•ˆå‹•ä½œ

---

## ğŸ¯ Phase 3ï¼šæ•´åˆæ¸¬è©¦ (1.5 å°æ™‚)

### æ¸¬è©¦å ´æ™¯

| å ´æ™¯ | æŒ‡ä»¤ | é æœŸçµæœ |
|------|------|---------|
| **å ´æ™¯ 1** | ã€Œè«‹ä½¿ç”¨ find_object å°‹æ‰¾ bottleã€ | è¿”å› found, distance_m, direction |
| **å ´æ™¯ 2** | ã€Œè«‹å°‹æ‰¾ cupï¼Œå¦‚æœæ‰¾åˆ°å°±æ‰“æ‹›å‘¼ã€ | find_object â†’ Hello |
| **å ´æ™¯ 3** | ã€Œä¾åºåŸ·è¡Œï¼šç«™èµ·ä¾† â†’ æ‰“æ‹›å‘¼ â†’ åä¸‹ã€ | StandUp â†’ Hello â†’ Sit |

### é©—æ”¶æ¨™æº–

- [ ] æˆåŠŸåŸ·è¡Œå ´æ™¯ 1-3
- [ ] éŒ¯èª¤è™•ç†æ­£ç¢ºï¼ˆGPU é›¢ç·šã€ç„¡æ•ˆå‹•ä½œï¼‰
- [ ] æ•ˆèƒ½é”æ¨™ï¼ˆfind_object < 5s, perform_action < 1sï¼‰

---

## ğŸ¯ Phase 4ï¼šå‚™æ¡ˆå½±ç‰‡è…³æœ¬

### Demo è…³æœ¬ï¼ˆä¸€é¡åˆ°åº•ï¼Œç´„ 70 ç§’ï¼‰

```
ğŸ¬ å ´æ™¯ï¼šæ¨¡æ“¬å±…å®¶å®¢å»³

1. é–‹å ´ï¼ˆ10 ç§’ï¼‰
   ğŸ‘´ ã€ŒGo2ï¼Œä½ å¥½ï¼ã€
   ğŸ• Go2 åŸ·è¡Œ Hello å‹•ä½œ

2. å°‹ç‰©ï¼ˆ30 ç§’ï¼‰
   ğŸ‘´ ã€Œå¹«æˆ‘æ‰¾æ¡Œä¸Šçš„æ°´ç“¶ã€
   ğŸ• Go2 æƒæç’°å¢ƒ â†’ ç™¼ç¾æ°´ç“¶ â†’ èµ°å‘ç›®æ¨™
   ğŸ’» è¢å¹•é¡¯ç¤ºï¼šæ„ŸçŸ¥ JSONï¼ˆè·é›¢ã€æ–¹å‘ï¼‰

3. äº’å‹•ï¼ˆ20 ç§’ï¼‰
   ğŸ‘´ ã€Œè¬è¬ä½ ï¼Œè·³å€‹èˆå§ã€
   ğŸ• Go2 åŸ·è¡Œ Dance1 å‹•ä½œ
   ğŸ‘´ ã€Œæ¯”å€‹æ„›å¿ƒã€
   ğŸ• Go2 åŸ·è¡Œ FingerHeart å‹•ä½œ

4. æ”¶å°¾ï¼ˆ10 ç§’ï¼‰
   ğŸ¤ æ—ç™½ï¼šã€Œé€™å°±æ˜¯è€äººèˆ‡ç‹—â€”â€”æ™ºèƒ½ AI æ©Ÿå™¨ç‹—ç³»çµ±ã€
```

### éŒ„å½±æ³¨æ„äº‹é …

- [ ] å ´åœ°å…‰ç·šå……è¶³ï¼ˆé¿å… YOLO èª¤åˆ¤ï¼‰
- [ ] ç›®æ¨™ç‰©è·é›¢æ§åˆ¶åœ¨ 0.3m - 1.5m
- [ ] ç¶²è·¯ç©©å®šï¼ˆä½¿ç”¨æœ‰ç·š or æ‰‹æ©Ÿç†±é»ï¼‰
- [ ] é éŒ„ 3 æ¬¡ï¼Œé¸æœ€ä½³ç‰ˆæœ¬

---

## â±ï¸ åŸ·è¡Œæ™‚é–“è»¸

| æ™‚é–“ | ä¸»ç·šä»»å‹™ | ä¸¦è¡Œä»»å‹™ |
|------|---------|---------|
| 0:00-0:30 | Phase 0 ç’°å¢ƒé©—è­‰ | - |
| 0:30-1:00 | Phase 1 find_object å¯¦ä½œ | å®‰è£ httpx |
| 1:00-1:30 | Phase 1 æ¸¬è©¦ | Phase 2 PerformAction.srv |
| 1:30-2:00 | Phase 1 é©—æ”¶ | Phase 2 Service å¯¦ä½œ |
| 2:00-2:30 | Phase 2 å»ºæ§‹æ¸¬è©¦ | - |
| 2:30-4:00 | Phase 3 æ•´åˆæ¸¬è©¦ | - |
| 4:00-4:30 | Phase 4 è…³æœ¬è¨­è¨ˆ | - |

### é—œéµæ±ºç­–é»

- **1:30** - Phase 1 æ˜¯å¦é€šéï¼Ÿå¦å‰‡å„ªå…ˆä¿®å¾©
- **2:30** - æ˜¯å¦æœ‰æ™‚é–“å®Œæ•´æ¸¬è©¦ï¼Ÿå¦å‰‡åŸ·è¡ŒåŸºç¤æ¸¬è©¦

---

## âš ï¸ é¢¨éšªç·©è§£

| é¢¨éšª | ç­‰ç´š | ç·©è§£æªæ–½ | æ‡‰å°æ–¹æ¡ˆ |
|------|------|---------|---------|
| GPU Server é€£ç·šå¤±æ•— | ğŸ”´ é«˜ | Phase 0 æå‰é©—è­‰ | Mock Server æˆ–é éŒ„å›æ‡‰ |
| ROS2 Service æ•´åˆå¤±æ•— | ğŸŸ¡ ä¸­ | åƒè€ƒ MoveForDuration.srv | Plan B: ç›´æ¥ publish_once |
| æ™‚é–“ä¸è¶³ | ğŸŸ¡ ä¸­ | Phase 2 å¯é™ç´š | æ‰‹å‹•å±•ç¤º + å½±ç‰‡è£œå…… |

---

## ğŸ“ é—œéµæª”æ¡ˆæ¸…å–®

### Phase 1 ä¿®æ”¹

- `ros-mcp-server/server.py` - æ–°å¢ `find_object` (~90 è¡Œ)

### Phase 2 ä¿®æ”¹

- `go2_interfaces/srv/PerformAction.srv` (æ–°æª”æ¡ˆ)
- `go2_interfaces/CMakeLists.txt` (1 è¡Œ)
- `go2_robot_sdk/.../robot_control_service.py` (~35 è¡Œ)
- `go2_robot_sdk/.../go2_driver_node.py` (~45 è¡Œ)
- `ros-mcp-server/server.py` - æ–°å¢ `go2_perform_action` (~50 è¡Œ)

**ç¸½ç¨‹å¼ç¢¼é‡ï¼š** ~230 è¡Œï¼ˆå«è¨»è§£èˆ‡éŒ¯èª¤è™•ç†ï¼‰

---

## ğŸ“‹ ä»Šæ—¥ä»»å‹™æª¢æŸ¥æ¸…å–®

### ğŸ”´ å¿…é ˆå®Œæˆ

- [ ] Phase 0ï¼šç’°å¢ƒé©—è­‰é€šé
- [ ] Phase 1ï¼š`find_object` MCP Tool é–‹ç™¼
- [ ] Phase 1 æ¸¬è©¦é€šé

### ğŸŸ¡ æ‡‰è©²å®Œæˆ

- [ ] Phase 2ï¼š`go2_perform_action` MCP Tool é–‹ç™¼
- [ ] Phase 3ï¼šè‡³å°‘ 1 å€‹æ•´åˆå ´æ™¯æˆåŠŸ

### ğŸ”µ å¯é¸

- [ ] Phase 4ï¼šå‚™æ¡ˆå½±ç‰‡è…³æœ¬å®šç¨¿
- [ ] å¤šå ´æ™¯æ¸¬è©¦ï¼ˆbottle, cup, chairï¼‰

---

## ğŸ”— ç›¸é—œè³‡æº

- [Perception Server V2](file:///home/roy422/Yoloworld/perception_server_v2.py)
- [ros-mcp-server](../../ros-mcp-server/)
- [æ˜¨æ—¥é€²åº¦ (12/20)](./2025-12-20-dev.md)
- [Go2 å‹•ä½œåº«](../../../go2_robot_sdk/go2_robot_sdk/domain/constants/robot_commands.py)

---

**è¨ˆç•«å»ºç«‹æ™‚é–“ï¼š** 2025-12-21 14:00  
**é ä¼°åŸ·è¡Œæ™‚é–“ï¼š** 4-5 å°æ™‚  
**æˆåŠŸç‡é ä¼°ï¼š** 85%ï¼ˆPhase 1 å¿…æˆï¼ŒPhase 2 é«˜æ©Ÿç‡å®Œæˆï¼‰
