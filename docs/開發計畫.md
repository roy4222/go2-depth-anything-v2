# Go2 æ™ºæ…§å°‹ç‰©ç³»çµ±é–‹ç™¼è¨ˆç•«

**å ±å‘Šæ—¥æœŸï¼š** 2025/12/06ï¼ˆMCP æ¶æ§‹ç‰ˆæœ¬ï¼‰  
**æ–‡ä»¶ç‰ˆæœ¬ï¼š** v3.0 (MCP Pivot)  
**åˆ†æåŸºç¤ï¼š** ros-mcp-server æŠ€è¡“ç ”ç©¶ + 2025/12/03 æœƒè­°æ±ºè­°

---

## 1. é–‹ç™¼è¨ˆç•«ç¸½è¦½

### 1.1 æ¶æ§‹è½‰å‹èªªæ˜

| é …ç›® | åŸè¨ˆç•« (v2.0) | æ–°è¨ˆç•« (v3.0) | è®Šæ›´ç†ç”± |
|------|--------------|--------------|---------|
| **è¦–è¦ºè™•ç†** | COCO VLM æœ¬åœ°æ¨è«– | LLM Vision (Snapshot) | è§£æ±ºå»¶é²å•é¡Œï¼Œèªæ„ç†è§£æ›´å¼· |
| **æ§åˆ¶ä»‹é¢** | è‡ªè¨‚ ROS2 ç¯€é» | MCP æ¨™æº–å”å®š | é–‹ç™¼æ•ˆç‡é«˜ï¼Œæ“´å……æ€§å¼· |
| **æ±ºç­–é‚è¼¯** | FSM ç‹€æ…‹æ©Ÿ | LLM Agent | èƒ½è™•ç†æ¨¡ç³ŠæŒ‡ä»¤ |
| **åº§æ¨™è½‰æ›** | LiDAR æŠ•å½± + tf2 | LLM è¦–è¦ºåˆ¤æ–· + Nav2 | é™ä½æŠ€è¡“è¤‡é›œåº¦ |

### 1.2 ç¾æ³è©•ä¼°

| æ¨¡çµ„ | é€²åº¦ | å‚™è¨» |
|------|------|------|
| **åŸºç¤å»ºè¨­ (ROS2 + SDK)** | âœ… 100% | go2_robot_sdk ç©©å®šé‹è¡Œ |
| **SLAM + Nav2** | âœ… 100% | robot.launch.py å·²é©—è­‰ |
| **æ„Ÿæ¸¬å™¨æ•´åˆ** | âœ… 100% | LiDAR/Camera/IMU Topic æ­£å¸¸ |
| **é›™æ©‹æ¥ç¶²è·¯** | âœ… 100% | Mac VM â†” Windows â†” Go2 |
| **ros-mcp-server ç ”ç©¶** | âœ… 100% | Clone å®Œæˆï¼Œæ¶æ§‹åˆ†æå®Œç•¢ |
| **rosbridge éƒ¨ç½²** | âœ… 100% | Port 9090 é‹è¡Œæ­£å¸¸ (12/6) |
| **MCP ä¸²æ¥é©—è­‰** | âœ… 100% | /cmd_vel + /capture_snapshot æˆåŠŸ (12/8) |
| **snapshot_service** | âœ… 100% | å¯é€é MCP æ“·å– JPEG (12/7) |
| **FSM Adapter** | â³ å¾…è©•ä¼° | å¯èƒ½ä¸éœ€è¦ï¼ŒMCP å¯ç›´æ¥æ§åˆ¶ |

---

## 2. ç³»çµ±æ¶æ§‹

### 2.1 æ•´åˆæ¶æ§‹åœ–

```mermaid
graph TD
    subgraph Host["Host ç«¯ (Windows/Mac)"]
        Claude["Claude Desktop / API"]
        MCPServer["ros-mcp-server"]
    end

    subgraph VM["Ubuntu VM (192.168.1.200)"]
        RosBridge["rosbridge_server<br/>(Port 9090)"]
        Go2SDK["go2_robot_sdk"]
        Nav2["Nav2 + SLAM"]
        FSMAdapter["fsm_adapter_node"]
        SnapshotSvc["snapshot_service"]
    end

    subgraph Go2["Unitree Go2 (192.168.12.1)"]
        Hardware["æ©Ÿå™¨ç‹—ç¡¬é«”"]
        Sensors["LiDAR/Camera/IMU"]
    end

    Claude --"MCP (stdio)"--> MCPServer
    MCPServer --"WebSocket"--> RosBridge
    RosBridge --> Go2SDK
    RosBridge --> FSMAdapter
    RosBridge --> SnapshotSvc
    FSMAdapter --> Nav2
    Go2SDK --"WebRTC"--> Hardware
    Sensors --> Go2SDK
    SnapshotSvc --"Image"--> MCPServer
```

### 2.2 ROS2 ç¯€é»é€šè¨Šæ¶æ§‹

```mermaid
graph LR
    subgraph Existing["ç¾æœ‰ç¯€é» (go2_robot_sdk)"]
        Driver["go2_driver_node"]
        Driver --> CmdVel["/cmd_vel"]
        Driver --> Camera["/camera/image_raw"]
        Driver --> PointCloud["/point_cloud2"]
        Driver --> IMU["/imu"]
    end

    subgraph New["æ–°å¢ç¯€é»"]
        RosBridge["rosbridge_websocket"]
        FSM["fsm_adapter_node"]
        Snapshot["snapshot_service"]
    end

    subgraph Nav["å°èˆªå †ç–Š"]
        SLAM["slam_toolbox"]
        Nav2Planner["Nav2 Planner"]
        Nav2Controller["Nav2 Controller"]
    end

    RosBridge <--> CmdVel
    RosBridge <--> Camera
    Snapshot --> Camera
    FSM --> LLMCmd["/llm_command"]
    FSM --> Nav2Planner
    PointCloud --> SLAM
    SLAM --> Nav2Planner
    Nav2Controller --> CmdVel
```

### 2.3 æ¨¡çµ„è·è²¬èªªæ˜

| æ¨¡çµ„ | æª”æ¡ˆä½ç½® | åŠŸèƒ½ |
|------|---------|------|
| **rosbridge_server** | apt å®‰è£ | WebSocket æ©‹æ¥ï¼Œè®“ ros-mcp-server èƒ½å­˜å– ROS2 |
| **ros-mcp-server** | `ros-mcp-server/` | MCP å”å®šå¯¦ä½œï¼Œ**æ”¯æ´ Action**ï¼ŒLLM é€éæ­¤æ§åˆ¶ ROS2 |
| **snapshot_service** | `src/vision/snapshot_service.py` | æ“·å–ç›¸æ©Ÿåœ–åƒï¼Œå£“ç¸®ç‚º JPEG å›å‚³ |

### 2.4 åº§æ¨™ç³»çµ±ç´„å®šï¼ˆé‡è¦ï¼ï¼‰

**é—œéµåº§æ¨™æ¡†æ¶ï¼š**

| åº§æ¨™æ¡†æ¶ | èªªæ˜ | æ³¨æ„äº‹é … |
|---------|------|----------|
| `map` | SLAM ä¸–ç•Œåº§æ¨™ç³» | Nav2 ç›®æ¨™é»ä½¿ç”¨æ­¤æ¡†æ¶ |
| `odom` | é‡Œç¨‹è¨ˆåº§æ¨™ç³» | ç›¸å°ä½ç§»è¿½è¹¤ |
| `base_link` | æ©Ÿå™¨ç‹—æœ¬é«”ä¸­å¿ƒ | é‹å‹•æ§åˆ¶åƒè€ƒé» |
| `front_camera` | å‰ç½®ç›¸æ©Ÿ | âš ï¸ **ä¸æ˜¯** `camera_link` |
| `lidar_link` | LiDAR åº§æ¨™ç³» | é»é›²è³‡æ–™ä¾†æº |

> âš ï¸ **æ³¨æ„ï¼š** ç›¸æ©Ÿåº§æ¨™æ¡†æ¶åç¨±ç‚º `front_camera`ï¼Œä¸æ˜¯å¸¸è¦‹çš„ `camera_link`ã€‚
> æ‰€æœ‰ TF æŸ¥è©¢å¿…é ˆä½¿ç”¨æ­£ç¢ºåç¨±ï¼Œå¦å‰‡æœƒå¤±æ•—ã€‚

```python
# æ­£ç¢ºç”¨æ³•
transform = tf_buffer.lookup_transform('map', 'front_camera', time)

# éŒ¯èª¤ç”¨æ³•ï¼ˆæœƒå¤±æ•—ï¼ï¼‰
transform = tf_buffer.lookup_transform('map', 'camera_link', time)  # âŒ
```

---

## 3. è©³ç´°æ™‚ç¨‹è¦åŠƒ

### W6 (12/2-12/8)ï¼šMCP åŸºç¤ä¸²æ¥ âœ… å·²å®Œæˆ

**ç›®æ¨™ï¼š** è®“ LLM èƒ½é€é MCP æ§åˆ¶æ©Ÿå™¨ç‹—åŸºæœ¬ç§»å‹•

| æ—¥æœŸ | ä»»å‹™ | é©—æ”¶æ¨™æº– | ç‹€æ…‹ |
|------|------|---------| -----|
| 12/6 (äº”) | å®‰è£ rosbridge_server | `ros2 launch rosbridge_server rosbridge_websocket_launch.xml` æˆåŠŸ | âœ… |
| 12/7 (å…­) | é–‹ç™¼ snapshot_service | `/capture_snapshot` å›å‚³ base64 JPEG | âœ… |
| 12/7 (å…­) | é…ç½® Kilo Code MCP | ros-mcp-server é€£ç·šæˆåŠŸ | âœ… |
| 12/8 (æ—¥) | é©—è­‰ /cmd_vel æ§åˆ¶ | Kilo Code è¼¸å…¥ã€Œå¾€å‰èµ°ã€ï¼Œæ©Ÿå™¨ç‹—ç§»å‹• | âœ… |
| 12/8 (æ—¥) | é©—è­‰ /capture_snapshot | Kilo Code å‘¼å«æœå‹™ï¼Œå–å¾— JPEG | âœ… |

**W6 æˆæœæ‘˜è¦ï¼š**
- MCP æ§åˆ¶éˆå®Œæ•´é©—è­‰ï¼š`Kilo Code â†’ ros-mcp-server â†’ rosbridge â†’ ROS2 â†’ Go2`
- snapshot_service é–‹ç™¼å®Œæˆï¼Œæ”¯æ´ MCP å‘¼å«
- Nav2 å°èˆªéƒ¨åˆ†æˆåŠŸï¼ˆå¾…å„ªåŒ– /scan é »ç‡ï¼‰

**æŠ€è¡“ç´°ç¯€ï¼š**

```bash
# VM ç«¯å®‰è£
sudo apt install ros-humble-rosbridge-server

# å•Ÿå‹• rosbridge
ros2 launch rosbridge_server rosbridge_websocket_launch.xml

# å•Ÿå‹• snapshot_serviceï¼ˆå¿…é ˆå–®ç¨å•Ÿå‹•ï¼‰
ros2 run go2_robot_sdk snapshot_service

# Host ç«¯é…ç½® Claude Desktop (~/.config/Claude/claude_desktop_config.json)
{
  "mcpServers": {
    "ros-mcp-server": {
      "command": "uvx",
      "args": ["ros-mcp", "--transport=stdio"]
    }
  }
}
```

---

### W7 (12/9-12/15)ï¼šè¦–è¦ºé–‰ç’° + Action é©—è­‰

**ç›®æ¨™ï¼š** LLM èƒ½çœ‹è¦‹ç’°å¢ƒä¸¦é€é Action æ§åˆ¶å°èˆª

| æ—¥æœŸ | ä»»å‹™ | é©—æ”¶æ¨™æº– |
|------|------|---------|
| 12/9 | **å„ªå…ˆé©—è­‰ MCP Action** | `send_action_goal('/navigate_to_pose', ...)` æˆåŠŸ |
| 12/10-11 | é–‹ç™¼ snapshot_service | `/capture_snapshot` å›å‚³ base64 åœ–ç‰‡ |
| 12/12-13 | YOLO vs COCO å¿«é€Ÿæ¸¬è©¦ | é¸å®š VLM æ–¹æ¡ˆ |
| 12/14-15 | è¦–è¦ºé–‰ç’°æ•´åˆ | LLM æè¿°ã€Œæˆ‘çœ‹è¦‹å‰æ–¹æœ‰éšœç¤™ç‰©ã€ |

**W7 Day 1 å„ªå…ˆæ¸¬è©¦è…³æœ¬ï¼ˆ12/9ï¼‰ï¼š**

```python
# æ¸¬è©¦ MCP Action æ§åˆ¶ Nav2
send_action_goal(
    action_name="/navigate_to_pose",
    action_type="nav2_msgs/action/NavigateToPose",
    goal={
        'pose': {
            'header': {'frame_id': 'map'},
            'pose': {
                'position': {'x': 1.0, 'y': 0.0, 'z': 0.0},
                'orientation': {'w': 1.0}
            }
        }
    },
    timeout=30.0
)
```

> âœ… **è‹¥æˆåŠŸï¼š** çœä¸‹ 5-7 å¤© FSM Adapter é–‹ç™¼æ™‚é–“ï¼
> âš ï¸ **è‹¥å¤±æ•—ï¼š** ç«‹å³å•Ÿå‹•å‚™æ¡ˆï¼Œé–‹ç™¼ç°¡åŒ–ç‰ˆç‹€æ…‹ç®¡ç†å™¨ã€‚

**snapshot_service è¦æ ¼ï¼š**

> ğŸ’¡ **åœ–åƒå£“ç¸®å»ºè­°ï¼š**
> - Claude ä¸éœ€è¦ 4K ç•«è³ªå°±èƒ½è¾¨è­˜ã€Œæ°´ç“¶ã€æˆ–ã€Œç´™ç®±ã€
> - å»ºè­° Resize åˆ° **640x480** ç”šè‡³æ›´å°ï¼ŒJPEG å£“ç¸®å“è³ªè¨­ç‚º **50-70**
> - **åŸå› ï¼š** Base64 ç·¨ç¢¼å¾Œå­—ä¸²å¾ˆé•·ï¼Œä½”ç”¨å¤§é‡ Context Tokenï¼Œå¢åŠ  Claude æ€è€ƒæ™‚é–“

```python
# snapshot_service.py
from sensor_msgs.msg import Image
from std_srvs.srv import Trigger
import cv2
import base64

# åœ–åƒå£“ç¸®è¨­å®šï¼ˆå„ªåŒ– Token ä½¿ç”¨ï¼‰
TARGET_WIDTH = 640
TARGET_HEIGHT = 480
JPEG_QUALITY = 60  # 50-70 å»ºè­°

class SnapshotService(Node):
    def __init__(self):
        super().__init__('snapshot_service')
        self.bridge = CvBridge()
        self.latest_image = None
        self.create_subscription(Image, '/camera/image_raw', self.image_callback, 10)
        self.create_service(Trigger, '/capture_snapshot', self.capture_callback)

    def image_callback(self, msg):
        self.latest_image = msg

    def capture_callback(self, request, response):
        if self.latest_image:
            cv_image = self.bridge.imgmsg_to_cv2(self.latest_image, 'bgr8')
            # Resize ä»¥æ¸›å°‘ Token ä½¿ç”¨
            resized = cv2.resize(cv_image, (TARGET_WIDTH, TARGET_HEIGHT))
            # JPEG å£“ç¸®
            _, jpeg = cv2.imencode('.jpg', resized, [cv2.IMWRITE_JPEG_QUALITY, JPEG_QUALITY])
            response.message = base64.b64encode(jpeg.tobytes()).decode()
            response.success = True
        return response
```

**fsm_adapter_node è¦æ ¼ï¼ˆSafety Layerï¼‰ï¼š**

> âš ï¸ **å®‰å…¨å±¤è¨­è¨ˆé‡é»ï¼š**
> - **ä¸è¦è®“ LLM ç›´æ¥ç™¼å¸ƒ `/cmd_vel`ï¼**
> - LLM å¯èƒ½å¹»è¦ºè¼¸å‡º `linear.x = 10.0`ï¼ˆå®ƒä»¥ç‚º cm/sï¼Œä½† ROS æ˜¯ m/sï¼‰
> - FSM Adapter ä½œç‚º Safety Layerï¼Œé™åˆ¶æœ€å¤§é€Ÿåº¦èˆ‡åŠ é€Ÿåº¦

```python
# fsm_adapter.py (Safety Layer)
from std_msgs.msg import String
from geometry_msgs.msg import Twist
from nav2_msgs.action import NavigateToPose
import json

# å®‰å…¨é™åˆ¶
MAX_LINEAR_SPEED = 0.5   # m/s
MAX_ANGULAR_SPEED = 1.0  # rad/s

class FSMAdapter(Node):
    def __init__(self):
        super().__init__('fsm_adapter')
        self.cmd_vel_pub = self.create_publisher(Twist, '/cmd_vel', 10)
        self.create_subscription(String, '/llm_command', self.command_callback, 10)
        self.nav2_client = ActionClient(self, NavigateToPose, 'navigate_to_pose')

    def command_callback(self, msg):
        try:
            cmd = json.loads(msg.data)  # {"action": "move", "direction": "forward", "distance": 1.0}
        except json.JSONDecodeError:
            cmd = {'action': msg.data.lower()}  # ç´”æ–‡å­—æŒ‡ä»¤
        
        if cmd.get('action') == 'move':
            self.send_velocity_safe(
                linear=min(cmd.get('speed', 0.3), MAX_LINEAR_SPEED),
                angular=0.0
            )
        elif cmd.get('action') in ['forward', 'move']:
            self.send_velocity_safe(0.3, 0.0)
        elif cmd.get('action') == 'turn_left':
            self.send_velocity_safe(0.0, min(0.5, MAX_ANGULAR_SPEED))
        elif cmd.get('action') == 'stop':
            self.send_velocity_safe(0.0, 0.0)
        elif cmd.get('action') == 'goto':
            self.send_nav2_goal(cmd.get('x', 0), cmd.get('y', 0))

    def send_velocity_safe(self, linear, angular):
        """Safety-limited velocity publishing"""
        twist = Twist()
        twist.linear.x = max(-MAX_LINEAR_SPEED, min(linear, MAX_LINEAR_SPEED))
        twist.angular.z = max(-MAX_ANGULAR_SPEED, min(angular, MAX_ANGULAR_SPEED))
        self.cmd_vel_pub.publish(twist)
```

---

### W8 (12/16-12/22)ï¼šå°‹ç‰©æƒ…å¢ƒæ•´åˆ + æ„ŸçŸ¥ç³»çµ±å‡ç´š

**ç›®æ¨™ï¼š** å¯¦ç¾ã€Œå¹«æˆ‘æ‰¾çœ¼é¡ã€å®Œæ•´æµç¨‹ï¼Œä¸¦æå‡é¿éšœæˆåŠŸç‡è‡³ 80%+

| æ—¥æœŸ | ä»»å‹™ | é©—æ”¶æ¨™æº– |
|------|------|---------|
| 12/14-15 | GPU ä¼ºæœå™¨ï¼šå®‰è£ DA3 + YOLO-World | FastAPI Server å¯å›æ‡‰ `/perceive` |
| 12/16 | Mac VMï¼šé–‹ç™¼ perception_client_node | `/perception_context` æ­£å¸¸ç™¼å¸ƒ |
| 12/17 | æ•´åˆæ¸¬è©¦ + æ›´æ–° mcp_system_prompt.md | LLM å¯è¨‚é–±æ„ŸçŸ¥æ‘˜è¦ |
| 12/18-19 | è¨­è¨ˆ 1/7 å±•ç¤ºè·¯ç·š | å®¢å»³å ´æ™¯ï¼šèµ·é» â†’ éšœç¤™ç‰© â†’ ç›®æ¨™ç‰© |
| 12/20-21 | é¿éšœé©—è­‰æ¸¬è©¦ | 5 æ¬¡ä¸­ 4 æ¬¡æˆåŠŸï¼ˆ80%+ï¼‰ |
| 12/22 | ç«¯åˆ°ç«¯æ¸¬è©¦ | å®Œæˆã€Œæ‰¾æ°´ã€å®Œæ•´æµç¨‹ |

#### æ„ŸçŸ¥ç³»çµ±æ¶æ§‹ (DA3 + YOLO-World)

```mermaid
graph LR
    subgraph GPU["GPU ä¼ºæœå™¨ (å­¸æ ¡æ©Ÿæˆ¿)"]
        FastAPI["FastAPI :8000"]
        YOLO["YOLO-World\n(ç‰©ä»¶åµæ¸¬)"]
        DA3["DA3 Metric\n(æ·±åº¦ä¼°è¨ˆ)"]
        FastAPI --> YOLO
        FastAPI --> DA3
    end
    
    subgraph VM["Mac VM (ROS2)"]
        Client["perception_client_node"]
        Context["/perception_context"]
        Client --> Context
    end
    
    Client --"HTTP POST\n(åœ–ç‰‡)"-->FastAPI
    FastAPI --"JSON\n(æ‘˜è¦)"-->Client
```

**æŠ€è¡“è¦æ ¼ï¼š**

| æ¨¡å‹ | ç”¨é€” | è¼¸å‡º |
|------|------|------|
| **YOLO-World-L** | é–‹æ”¾è©å½™ç‰©ä»¶åµæ¸¬ | `{class: "æ°´ç“¶", bbox: [...], conf: 0.85}` |
| **DA3METRIC-LARGE** | çœŸå¯¦è·é›¢ä¼°è¨ˆ | æ·±åº¦åœ– (å…¬å°º) |

**åµæ¸¬é¡åˆ¥ï¼š** `["æ°´ç“¶", "çœ¼é¡", "è—¥ç›’", "æ¤…å­", "æ¡Œå­", "ç´™ç®±", "äºº"]`

**æ„ŸçŸ¥æ‘˜è¦æ ¼å¼ï¼š**

```
[ç’°å¢ƒæ„ŸçŸ¥æ‘˜è¦]
- æ­£å‰æ–¹ 0.8mï¼šç´™ç®±ï¼ˆéšœç¤™ç‰©ï¼‰
- å³å´ 2.3mï¼šæ°´ç“¶ï¼ˆç›®æ¨™ï¼‰
- å·¦å´æš¢é€š
âš ï¸ å»ºè­°ï¼šå‘å·¦ç¹è¡Œ
```

> ğŸ“– **è©³ç´°æŒ‡å—**ï¼š[Depth Anything V2 å®‰è£æŒ‡å—](../01-guides/Depth%20Anything%20V2/depth-anything-v2-guide.md)

**LLM System Prompt ç¯„ä¾‹ï¼ˆå« Prompt Engineering æŠ€å·§ï¼‰ï¼š**

```markdown
ä½ æ˜¯ã€Œå°ç‹—ã€ï¼Œä¸€éš»è²¼å¿ƒçš„ AI æ©Ÿå™¨ç‹—ã€‚

## è§’è‰²è¨­å®š
- ä½ çš„ä¸»äººæ˜¯ä¸€ä½å¹´é•·çš„çˆ¶çˆ¶/å¥¶å¥¶
- ä½ èªªè©±è¦æº«æš–ã€ç°¡çŸ­ã€æ˜“æ‡‚
- ä½ æœƒå¹«ä¸»äººæ‰¾æ±è¥¿ï¼Œä¸¦ç”¨ç°¡å–®çš„è©±æè¿°ä½ç½®

## åº§æ¨™ç³»çµ±ï¼ˆé‡è¦ï¼ï¼‰
- ä½ æ˜¯åŸºæ–¼ `map` åº§æ¨™ç³»æ€è€ƒ
- ç•¶ä½ çœ‹åˆ°éšœç¤™ç‰©åœ¨ç•«é¢å·¦é‚Šï¼Œä»£è¡¨ä½ éœ€è¦å‘å³æ—‹è½‰
- ç•¶ä½ çœ‹åˆ°éšœç¤™ç‰©åœ¨ç•«é¢å³é‚Šï¼Œä»£è¡¨ä½ éœ€è¦å‘å·¦æ—‹è½‰

## å¯ç”¨å·¥å…·
- `subscribe_once('/camera/image_raw', 'sensor_msgs/Image')` - çœ‹ç’°å¢ƒ
- `analyze_previously_received_image()` - åˆ†æåœ–ç‰‡
- `publish_once('/llm_command', 'std_msgs/String', {'data': '{"action": "forward"}'})` - ç™¼é€æŒ‡ä»¤

## è¡Œç‚ºæº–å‰‡ï¼ˆChain of Thoughtï¼‰
1. æ”¶åˆ°å°‹ç‰©æŒ‡ä»¤å¾Œï¼Œå…ˆå·¡è¦–ç’°å¢ƒ
2. **å…ˆè¼¸å‡ºæ€è€ƒéç¨‹ï¼Œå†å‘¼å«å·¥å…·**ï¼š
   <thought>æˆ‘çœ‹åˆ°å‰æ–¹æœ‰ç´™ç®±ï¼Œæ‡‰è©²å·¦è½‰ç¹é...</thought>
3. æ¯ç§»å‹• 2-3 ç§’å¾Œæˆªåœ–è§€å¯Ÿ
4. æ‰¾åˆ°ç›®æ¨™ç‰©å¾Œï¼Œç”¨æº«æš–çš„è©±å‘Šè¨´ä¸»äºº
```

---

### W9-W10 (12/23-1/6)ï¼šç©©å®šæ€§æ¸¬è©¦èˆ‡ Demo æº–å‚™

**ç›®æ¨™ï¼š** Demo æˆåŠŸç‡ > 80%

| æ—¥æœŸ | ä»»å‹™ | é©—æ”¶æ¨™æº– |
|------|------|---------|
| 12/23-25 | å£“åŠ›æ¸¬è©¦ | é€£çºŒé‹è¡Œ 10 åˆ†é˜ç„¡æ•…éšœ |
| 12/26-28 | éŒ„è£½å‚™æ¡ˆå½±ç‰‡ | ä¸€é¡åˆ°åº•æˆåŠŸå½±ç‰‡ |
| 12/29-31 | æº–å‚™ç°¡å ± | PPT + å£é ­å ±å‘Šç¨¿ |
| 1/1-3 | å‡æœŸä¼‘æ¯ | - |
| 1/4-6 | å¯¦æ©Ÿæ¼”ç·´ | å®Œæ•´ Demo å½©æ’ 3 æ¬¡ |

**Demo æº–å‚™é—œéµå»ºè­°ï¼š**

> ğŸ“‹ **1. é å…ˆå»ºåœ– (Pre-mapping)**
> - **ä¸è¦åœ¨ Demo ç•¶ä¸‹è·‘ SLAM å»ºåœ–ï¼**
> - è«‹æå‰å»ºå¥½ `map` ä¸¦å„²å­˜ (`ros2 run nav2_map_server map_saver_cli -f ~/maps/demo_map`)
> - Demo æ™‚åªè·‘ `AMCL` (å®šä½) + `Nav2`ï¼Œé™ä½é‹ç®—è² è¼‰ï¼Œæ¸›å°‘å‡ºéŒ¯æ©Ÿç‡

> ğŸŒ **2. ç¶²è·¯æ¸¬è©¦ (W6 çµæŸå‰å¿…åš)**
> ```bash
> # å¾ Host ç«¯æ¸¬è©¦ rosbridge é€£ç·š
> # å®‰è£ wscat: npm install -g wscat
> wscat -c ws://192.168.x.x:9090
> 
> # æ‡‰è©²çœ‹åˆ°é€£ç·šæˆåŠŸï¼Œå¯è¼¸å…¥ JSON æ¸¬è©¦
> {"op": "call_service", "service": "/rosapi/topics"}
> ```
> - ç¢ºèª VM Port Forwarding å…è¨± 9090
> - æ¸¬é‡å»¶é² (ç›®æ¨™ < 100ms)

> ğŸ¬ **3. å‚™æ¡ˆå½±ç‰‡ (Plan B)**
> - éŒ„è£½ã€Œä¸€é¡åˆ°åº•ã€æˆåŠŸå½±ç‰‡
> - è‹¥ç¾å ´ç¶²è·¯/ç¡¬é«”å‡ºå•é¡Œï¼Œå¯ç«‹å³åˆ‡æ›æ’­æ”¾
> - å½±ç‰‡å…§å®¹ï¼šå®Œæ•´å°‹ç‰©æµç¨‹ + Claude å°è©±æˆªåœ–



## 4. æ•´åˆ Launch æª”æ¡ˆ

### 4.1 MCP æ•´åˆ Launch

å»ºç«‹ `launch/mcp_integration.launch.py`ï¼š

```python
from launch import LaunchDescription
from launch.actions import IncludeLaunchDescription
from launch.launch_description_sources import PythonLaunchDescriptionSource
from launch_ros.actions import Node
from ament_index_python.packages import get_package_share_directory
import os

def generate_launch_description():
    # ç¾æœ‰çš„ Go2 é©…å‹•
    go2_launch = IncludeLaunchDescription(
        PythonLaunchDescriptionSource([
            get_package_share_directory('go2_robot_sdk'),
            '/launch/robot.launch.py'
        ])
    )

    # rosbridge (MCP é€šè¨Šæ©‹æ¥)
    rosbridge_node = Node(
        package='rosbridge_server',
        executable='rosbridge_websocket',
        name='rosbridge_websocket',
        parameters=[{
            'port': 9090,
            'address': '',
            'use_compression': False,
            'max_message_size': 10000000,
        }]
    )

    # FSM Adapter (LLM æŒ‡ä»¤è½‰æ›) - Plan Bï¼Œåƒ…åœ¨ MCP Action é©—è­‰å¤±æ•—æ™‚å•Ÿç”¨
    # fsm_adapter_node = Node(
    #     package='go2_robot_sdk',
    #     executable='fsm_adapter',
    #     name='fsm_adapter',
    #     output='screen'
    # )

    # Snapshot Service (åœ–åƒæ“·å–) - å¯é¸ï¼Œros-mcp-server å…§å»º subscribe_once äº¦å¯ç”¨
    # ç”¨é€”ï¼šå›ºå®šå£“ç¸®è¨­å®šã€è§£æåº¦æ§åˆ¶ã€æœå‹™åŒ– API
    snapshot_node = Node(
        package='go2_robot_sdk',
        executable='snapshot_service',
        name='snapshot_service',
        output='screen'
    )

    return LaunchDescription([
        go2_launch,
        rosbridge_node,
        # fsm_adapter_node,  # å–æ¶ˆè¨»è§£ä»¥å•Ÿç”¨ (Plan B)
        snapshot_node,
    ])
```

### 4.2 ä½¿ç”¨æ–¹å¼

```bash
# ä¸€éµå•Ÿå‹•æ‰€æœ‰ç¯€é»
ros2 launch go2_robot_sdk mcp_integration.launch.py

# Host ç«¯å•Ÿå‹• ros-mcp-server
uvx ros-mcp --transport stdio
```

---

## 5. é¢¨éšªç®¡ç†

| é¢¨éšª | ç­‰ç´š | ç·©è§£æªæ–½ | å‚™æ¡ˆ |
|------|------|---------|------|
| **rosbridge é€£ç·šä¸ç©©** | ğŸŸ¡ ä¸­ | åŠ å…¥é‡é€£é‚è¼¯ | ä½¿ç”¨ Foxglove WebSocket |
| **LLM API å»¶é²** | ğŸŸ¡ ä¸­ | Snapshot ç­–ç•¥ | ä½¿ç”¨æœ¬åœ° LLM (Ollama) |
| **MCP Action æ”¯æ´** | ğŸŸ¡ ä¸­ | W7 Day 1 é©—è­‰ `send_action_goal()` | å¤±æ•—å‰‡å•Ÿå‹• FSM Adapter |
| **ç¶²è·¯ç’°å¢ƒè¤‡é›œ** | ğŸŸ¡ ä¸­ | é›™æ©‹æ¥é…ç½® | HTTP Transport |
| **Demo ç¾å ´æ•…éšœ** | ğŸ”´ é«˜ | å¤šæ¬¡å½©æ’ | é éŒ„å½±ç‰‡ |

> ğŸ’¡ **Action æ”¯æ´èªªæ˜ï¼š** ros-mcp-server æä¾› `send_action_goal()` å‡½å¼ï¼Œä½†éœ€é©—è­‰ rosbridge/rosapi æ˜¯å¦æä¾›å®Œæ•´ action servicesã€‚è‹¥é©—è­‰å¤±æ•—ï¼Œå‰‡é–‹ç™¼ FSM Adapter ä½œç‚ºè½‰æ¥å±¤ã€‚

---

## 6. è³‡æºæ¸…å–®

### 6.1 è»Ÿé«”ä¾è³´

| å¥—ä»¶ | ç‰ˆæœ¬ | å®‰è£æ–¹å¼ |
|------|------|---------|
| ROS2 Humble | 2022.11 | apt |
| rosbridge_server | humble | `sudo apt install ros-humble-rosbridge-server` |
| ros-mcp-server | latest | `uvx ros-mcp` |
| Claude API | 3.5 Sonnet | API Key |

### 6.2 ç¡¬é«”éœ€æ±‚

| è¨­å‚™ | è¦æ ¼ | ç”¨é€” |
|------|------|------|
| Mac (UTM VM) | Ubuntu 22.04, 8GB RAM | ROS2 é‹ç®— |
| Windows PC | RViz2 è¦–è¦ºåŒ– | é–‹ç™¼ç›£æ§ |
| Unitree Go2 | EDU ç‰ˆæœ¬ | æ©Ÿå™¨ç‹—å¯¦æ©Ÿ |

---

## 7. é—œéµæ™‚ç¨‹é‡Œç¨‹ç¢‘

| æ—¥æœŸ | é‡Œç¨‹ç¢‘ | é©—æ”¶æ¨™æº– |
|------|--------|---------|
| **12/8** | MCP åŸºç¤ä¸²æ¥å®Œæˆ | Claude èƒ½æ§åˆ¶æ©Ÿå™¨ç‹—ç§»å‹• |
| **12/15** | è¦–è¦ºé–‰ç’°å®Œæˆ | LLM èƒ½çœ‹è¦‹ä¸¦æè¿°ç’°å¢ƒ |
| **12/22** | å°‹ç‰©æƒ…å¢ƒå®Œæˆ | ã€Œæ‰¾æ°´ã€æµç¨‹é‹ä½œ |
| **1/6** | Demo æº–å‚™å®Œæˆ | æˆåŠŸç‡ > 80% |
| **1/7** | **å°ˆé¡Œç™¼è¡¨** | ç¾å ´æ¼”ç¤ºæˆåŠŸ |

---

## 8. ç›¸é—œæ–‡ä»¶

- [å°ˆé¡Œç›®æ¨™ï¼ˆé¡˜æ™¯èˆ‡æ¶æ§‹ï¼‰](./å°ˆé¡Œç›®æ¨™.md)
- [ros-mcp-server æŠ€è¡“ç ”ç©¶](../../ros-mcp-server/README.md)
- [ros-mcp-server Go2 ç¯„ä¾‹](../../ros-mcp-server/examples/4_unitree_go2/)
- [CycloneDDS é…ç½®æŒ‡å—](../01-guides/cyclonedds-config-guide.md)
- [Phase 1 æ¸¬è©¦è…³æœ¬](../../phase1_test.sh)

---

**è¨ˆç•«æ›´æ–°å®Œæˆï¼æº–å‚™é–‹å§‹ MCP æ•´åˆã€‚** ğŸš€
